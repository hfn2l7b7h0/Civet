Hera from ../source/parser.hera
{parse} := Hera

gen from ../source/generate.coffee
assert from assert

verbose := false

compare := (src, result, filename) ->
  ast := parse(src, {filename, verbose})
  assert.equal gen(gen.prune(ast), {}), result

testCase := (text) ->
  [desc, src, result] := text.split("\n---\n")

  it desc, ->
    compare src, result, desc

throws := (text) ->
  assert.throws ->
    gen(parse(text))

export {
  compare
  testCase
  throws
}
