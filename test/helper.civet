{ default as Civet } from ../source/main.coffee

{ compile } := Civet

assert from assert
cache := true

compare := (src: string, result: string, filename: string) ->
  compileResult := compile(src, {
    cache
    filename
  })

  assert.equal compileResult, result, """
    #{filename}
    --- Source   ---
    #{src}

    --- Expected ---
    #{result}

    --- Got      ---
    #{compileResult}

  """

testCase := (text: string) ->
  [desc, src, result] := text.split("\n---\n")

  it desc, ->
    compare src, result, desc

throws := (text: string) ->
  assert.throws ->
    compile text, {
      cache
    }

export {
  compare
  testCase
  throws
}
